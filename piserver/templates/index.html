<!DOCTYPE html >
<html  lang="en">
<head>
	 <meta charset="utf-8">
   <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

	<title>Pi Control Panel .demo</title>
<link rel="stylesheet" href="{{ url_for('static', filename='css/bootstrap.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/dropdowns-enhancement.min.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/font-awesome.min.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/button.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/head.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/zico.css') }}">
<script src="{{ url_for('static', filename='js/jquery-min.js') }}"></script>
<script src="{{ url_for('static', filename='js/bootstrap.min.js') }}"></script>
<script src="{{ url_for('static', filename='js/popper.js') }}"></script>
<script src="{{ url_for('static', filename='js/zico.js') }}"></script>
<script src="{{ url_for('static', filename='js/vue.js') }}"></script>
</head>
<body>
  {% raw %}
  <div class="container-fluid " id="app">
    <!--顶部菜单-->
    <div class="row">
      <div class="col-12">
      <nav class="navbar navbar-dark navbar-fixed-top bg-dark navbar-expand-lg">
        <a class="navbar-brand" href="#"><span class="zi zi_batteryquarter "></span> Pi Control Panel .demo</a>
      </nav>
    </div>
    </div>
  
  
    <div class="row">
  <table class="table table-bordered table-responsive　col-12">
  
  <tr>
    <td> 
        <div class="btn-group btn-group-sm border border-secondary rounded">
        <button type="button" class="btn btn-light ">
        <b>温度[℃]:</b> <span class="badge badge-secondary">100.00</span>
        <span class="badge badge-secondary">100.00</span>
        <span class="badge badge-secondary">100.00</span>
        </button>
        </div>
        <div class="btn-group btn-group-sm"> 　
        <button type="submit" class="btn btn-outline-info  " onclick="window.location.href = '/cp'">設定初期化</button>
        </div>
    </td>
  
    </tr>
  
  <tr>	
    <td>
  <!-- 输出结果 pre代码块 -->
  <div>
  <pre  class="pre-scrollable col-xs-12 col-md-7 text-justify border border-secondary bg-light rounded" id="outputTerminal">
  GPIO初期化完了 LED0点灯 gpio17==high 
  LED0==True
    
  
  
  </pre>  <!-- 维持宽度需要至少4行输出 -->

  </div>
  
  <!-- LED0和全部停止 -->
  <div class=" ">  
      <div class="btn-group btn-group-sm">
        <div class="input-group-prepend ">
        <div class="input-group-text ">LED0</div>
        </div>
        <button  class="btn btn-outline-success btn-sm " id="turnonLED0">ON</button>
        <button  class="btn btn-outline-secondary btn-sm " id="turnoffLED0">OFF</button>
      </div>
      <div class="btn-group ">
        &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp
        <button id="stop"class="btn btn-outline-danger " data-toggle="modal" data-target="#stopAll" >全部停止</button>
      </div>
      <!-- Modal -->
  <div class="modal fade" id="stopAll" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLongTitle">确定要全部停止吗？</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          马达，加热器将全部停止，LED0恢复初始。
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">No</button>
          <button type="button" class="btn btn-danger">确认</button>
        </div>
      </div>
    </div>
  </div>
  </div>
  
  </td>  
  </tr>
  
  <tr>
  <td >
  <!-- 折叠选项卡 -->
  <div>
    <ul class="nav nav-tabs" >
      <li class="nav-item">
        <a :class="tabMotorIsActive "  @click="showMotor" href="#">モータ</a>
      </li>
      <li class="nav-item">
        <a :class="tabTempIsActive "  @click="showTemp" href="#">温度</a>
      </li>
      <li class="nav-item">
        <a :class="tabSetupIsActive" href="#">设置</a>
      </li>
      <li class="nav-item">
        <a class="nav-link disabled" href="#">Disabled</a>
      </li>
    </ul>
  </div>
  <!-- {{ message }} -->
  <!-- <button @mouseup="warn1" @mousedown="warn2" class="btn btn-outline-dark btn-sm">Test</button> -->
  
  <!-- 马达折叠内容 -->
  <p>
  <div class="" v-if="isShowMotorTabContent ">
    

    
    <div  class="btn-group btn-group-sm col-xs-12 "> 
      <button v-if="isShowdcw" class="btn btn-outline-dark btn-sm" id="dcw" @click="btndcw">左 </button> 
      <button v-if="isShowdccw" class="btn btn-outline-dark " id="dccw" @click="btndccw">右</button>
      
      <button  @mousedown="btnmotordcwdown" @mouseup="btnmotordcwup" class="btn btn-secondary btn-sm "><</button>
      <button id="Tdirection"class="btn btn-outline-dark " style="width:70px;">{{Td}}s</button> 
      <button @mousedown="btnmotordccwdown" @mouseup="btnmotordccwup" class="btn btn-secondary btn-sm ">></button>
      
    </div>
    <br>
    <div style="height:5px;">  </div>
    <div  class="btn-group  " > 
     <!-- <span class="zi zi_pulse zi_copyright m-1 "></span> -->
      <button @click="motord1" id="motord1" class=" btn btn-outline-success  btn-lg ">正転</button>
      <button @click="motorstop" id="motorstop"class="btn btn-outline-secondary btn-lg"  style="width:120px;">停止</button>
      <button @click="motord2" id="motord2"class="btn btn-outline-success btn-lg ">逆転</button>
    </div>
    <div style="height:5px;">  </div>

      



    
  <div ></div>
    <div class="  "  autocomplete="on" >
      <div>
        <input type="button"  class="btn btn-info btn-sm" id="motorautorun" value="自動運転開始">
        <input type="button" class="btn btn-info btn-sm" id="motorautostop" value="停止(未完成)" disabled="on">

      </div>
      <div class="input-group-prepend    ">
        <div class="input-group-text">運転T1&nbsp&nbsp&nbsp</div>
        <input type="number" step="0.1" class="form-control col-md-1" id="motorrunningT1" min="0.1" placeholder="秒/S" value="1" autocomplete="on" required >
        <div class="input-group-text">加熱待ちT2</div>
        <input type="number"   step="0.1"class="form-control col-md-1" id="motorwaitingT2"  min="0.1" placeholder="秒/S" value="2" autocomplete="on" required>
      </div> 
  
      <div class="input-group col-xs-12 ">
        <div class="input-group-text">運転T3 &nbsp&nbsp</div>
        <input type="number"   step="0.1" class="form-control" id="motorrunningT3" min="0.1"  placeholder="秒/S" value="1" autocomplete="on" required>
        <div class="input-group-addon">加熱待ちT4</div>
        <input type="number"   step="0.1" class="form-control" id="motorwaitingT4" min="0.1"  placeholder="秒/S" value="2"  autocomplete="on" required>
      </div>
  
      <div class="input-group col-xs-12">
        <div class="input-group-text">逆運転T5</div>
        <input type="number"   step="0.1"class="form-control" id="motorrunningT5" min="0.1"  placeholder="秒/S"  value="1"  autocomplete="on" required>
        <div class="input-group-addon">加熱待ちT6</div>
        <input type="number"   step="0.1" class="form-control" id="motorwaitingT6"  min="0.1" placeholder="秒/S" value="2" autocomplete="on"  required>
      </div>
  
      <div class="input-group col-xs-12">
        <div class="input-group-text ">逆運転T7</div>
        <input type="number"   step="0.1"class="form-control" id="motorrunningT7" min="0.1"  placeholder="秒/S" value="1"  autocomplete="on"  required>
        <div class="input-group-addon">加熱待ちT8</div>
        <input type="number"   step="0.1" class="form-control" id="motorwaitingT8" min="0.1"  placeholder="秒/S" value="2"  autocomplete="on" required>
      </div>
  
    </div>
  </div>
  </p>
  
  <!-- 温度折叠内容 -->
  <p>
  <div v-if="isShowTempTabContent" >
  温度折叠 
  
  </div>
  </p>
  
  </td> 
  </tr>
   
  
  </table>
  
  
  </div> 
  <!-- 表格row -->
  
  <!-- container fluid -->
  </div>
  {% endraw %}
  
  
  
  <script>
    var app=new Vue({
      el:"#app",
      data:{
        isShowMotorTabContent:true,
        tabMotorIsActive:{ 'nav-link':true, 'active':true,},
        isShowTempTabContent:false,
        tabTempIsActive:{ 'nav-link':true, 'active':false,},
        isShowSetupTabContent:false,
        tabSetupIsActive:{ 'nav-link':true, 'disabled':true,},
        // 马达正反计算时间按钮
        isShowdccw:true,
        isShowdcw:false,
        Tdirection:"0.0",
        msdowncw:"0",
        msupcw:"0",
        tcw:"0",
        msupcw:"0",
        msdownccw:"0",
        tccw:"0",
        Td:"000.0"
        
  
      },
      methods:{
        showMotor:function(){
          this.isShowMotorTabContent = true;
          this.isShowTempTabContent=false;
          this.isShowSetupTabContent=false;
          this.tabMotorIsActive.active=true;
          this.tabTempIsActive.active=false;
          this.tabSetupIsActive.active=false;
        },
        showTemp:function(){
          this.isShowMotorTabContent = false;
          this.isShowTempTabContent=true;
          this.isShowSetupTabContent=false;
          this.tabMotorIsActive.active=false;
          this.tabTempIsActive.active=true;
          this.tabSetupIsActive.active=false;
        },
        // 马达计正反计算时间按钮
        btndcw:function(){
          this.isShowdcw=false;
          this.isShowdccw=true;
        },
        btndccw:function(){
          this.isShowdcw=true;
          this.isShowdccw=false;
        },
        btndcw1:function(){
          this.isShowdcw1=false;
          this.isShowbtnstpcw1=true;
        },
        btndccw1:function(){
          this.isShowccw1=false;
          this.isShowbtnstpccw1=true;
        },
        btnmotordcwdown:function(){ //按下马达左转，按钮左
          now=new Date();
          this.msdowncw=now.valueOf();
          // output="msdowncw "+this.msdowncw;
          console.log("msdowncw "+this.msdowncw)
  
        },
        btnmotordcwup:function(){ //抬起马达左转
          now=new Date();
          this.msupcw=now.valueOf()
          console.log("msupcw "+this.msupcw)
          this.tcw=this.msupcw-this.msdowncw;
          console.log("tcw "+this.tcw)
          if (this.isShowdcw==true && (this.tcw-this.tccw)!=0){
            this.Tdirection=(this.tcw-this.tccw+Number(this.Tdirection));
            this.Td=this.Tdirection/1000;
            console.log("if1 Tdirection "+this.Tdirection)
            this.Td=(this.Tdirection/1000).toFixed(1);
          };
          if (this.isShowdccw==true && (this.tccw-this.tcw)!=0){
            this.Tdirection=(this.tccw-this.tcw+Number(this.Tdirection))
            this.Td=(this.Tdirection/1000).toFixed(1);
            console.log("if2 Tdirection "+this.Tdirection);
          };
        },
        btnmotordccwdown:function(){ //按下马达右转,按钮右
          now=new Date();
          this.msdownccw=now.valueOf();
        },
        btnmotordccwup:function(){ //抬起马达右转
          now=new Date();
          this.msupccw=now.valueOf()
          console.log("msupccw "+this.msupccw)
          this.tccw=this.msupccw-this.msdownccw;
          console.log("tccw "+this.tccw)
          if (this.isShowdcw==true && (this.tcw-this.tccw)!=0){
            this.Tdirection=(this.tcw-this.tccw+Number(this.Tdirection));
            console.log("if1 Tdirection "+this.Tdirection)
            this.Td=(this.Tdirection/1000).toFixed(1);
          };
          if (this.isShowdccw==true && (this.tccw-this.tcw)!=0){
            this.Tdirection=(this.tccw-this.tcw+Number(this.Tdirection))
            this.Td=(this.Tdirection/1000).toFixed(1);
            console.log("if2 Tdirection "+this.Tdirection);
          };
          
        },
        motord1:function(){
          now=new Date();
          this.msdowncw=now.valueOf();
          this.tcww=this.msdowncw-this.msdownccw
          if (this.isShowdcw==true && (this.tcw-this.tccw)!=0){
            this.Tdirection=(this.tcw-this.tccw+Number(this.Tdirection));
            console.log("if1 Tdirection "+this.Tdirection)
            this.Td=(this.Tdirection/1000).toFixed(1);
          };
          if (this.isShowdccw==true && (this.tccw-this.tcw)!=0){
            this.Tdirection=(this.tccw-this.tcw+Number(this.Tdirection))
            this.Td=(this.Tdirection/1000).toFixed(1);
            console.log("if2 Tdirection "+this.Tdirection);
          };
          
        },
        motorstop:function(){

        },
        motord2:function(){
          now=new Date();
          this.msdownccw=now.valueOf();
          this.tcw=this.msdownccw-this.msdowncw
          if (this.isShowdcw==true && (this.tcw-this.tccw)!=0){
            this.Tdirection=(this.tcw-this.tccw+Number(this.Tdirection));
            console.log("if1 Tdirection "+this.Tdirection)
            this.Td=(this.Tdirection/1000).toFixed(1);
          };
          if (this.isShowdccw==true && (this.tccw-this.tcw)!=0){
            this.Tdirection=(this.tccw-this.tcw+Number(this.Tdirection))
            this.Td=(this.Tdirection/1000).toFixed(1);
            console.log("if2 Tdirection "+this.Tdirection);
          };
        },
  
  
        warn1:function(){
          this.showMotor();
        },
        warn2:function(){
          this.showTemp();
        }
        
      },
  })
  
  
  //测试脚本，测试id==bt1,路由==test	
  $(document).ready(function(){
    $("#bt1").click(function(){
      $.post("/cp/test",{},function(data,status){
        // alert("数据：" + data + "\n状态：" + status);
         $("#outputTerminal").text("方法：" + data + "状态：" + status);
      });
    });
  });
  
  
  
  //LED0高电平输出
  $(document).ready(function(){
    $("#turnonLED0").click(function(){
      $.post("/cp/pullupgpio/LED0",{},function(data,status){
         $("#outputTerminal").text(data +"GPIO4==True"+"\n状態：" + status+"");
      });
    });
  });
  
  //LED0低电平输出
  $(document).ready(function(){
    $("#turnoffLED0").click(function(){
      $.post("/cp/pulldowngpio/LED0",{},function(data,status){
         $("#outputTerminal").text(data +"GPIO4==False"+" \n状態：" + status+"");
      });
    });
  });
  
  //马达控制
  $(document).ready(function(){
    $("#motord1").click(function(){ //马达方向1
      $.post("/cp/motord1",{},function(data,status){
         $("#outputTerminal").text(data +" 状態：" + status);
      });
    });
  });
  
  $(document).ready(function(){
    $("#motord2").click(function(){  //马达方向2
      $.post("/cp/motord2",{},function(data,status){
         $("#outputTerminal").text(data +" 状態：" + status);
      });
    });
  });
  
  $(document).ready(function(){
    $("#motorstop").click(function(){  //马达停止
      $.post("/cp/motorstop",{},function(data,status){
         $("#outputTerminal").text(data +" 状態：" + status);
      });
    });
  });
  
  $(document).ready(function(){
    $("#motorautorun").click(function(){  //自动控制
      var t1=$("#motorrunningT1").val();
      var t2=$("#motorwaitingT2").val();
      var t3=$("#motorrunningT3").val();
      var t4=$("#motorwaitingT4").val();
      var t5=$("#motorrunningT5").val();
      var t6=$("#motorwaitingT6").val();
      var t7=$("#motorrunningT7").val();
      var t8=$("#motorwaitingT8").val();
      if (t1=="" || t2=="" || t3=="" ||t4 =="" || t5 =="" || t6=="" || t7=="" || t8=="" ) {
        $("#outputTerminal").text("T1~T8を全部入れてください。"+"\n"+"-\n-\n");
      }else{
        $("#outputTerminal").text("運転中　t1=" + t1+" t2="+t2+" t3="+t3+" t4="+t4+"\nt5="+t5+" t6="+t6+" t7="+t7+" t8="+t8 +"\n-");
        $.post("/cp/motorautorun/1",{
           "t1":t1,
           "t2":t2,
           "t3":t3,
           "t4":t4,
           "t5":t5,
           "t6":t6,
           "t7":t7,
           "t8":t8
          },function(data,status){
             $("#outputTerminal").text(data +"状態：\n" + status);
                 });
           }
  
          });
  
  
  $("#motorautostop").click(function(){  //马达停止
      $.post("/cp/motorautorun/0",{},function(data,status){
         $("#outputTerminal").text("自動運転完了" + data +" 状態：" + status);
      });
    });
  
  })
  　　 
  
  
  
  
  
  //刷新温度(1秒刷新一次)
  // $(document).ready(function(){
  //   //开始刷新按钮
  //   $("#t_Refresh").click(function(){
  //    var Tcount= setInterval(refreshTemp,2000);
  //   });
  
  //  $("#t_stopRefresh").click(function(){
  //     // clearInterval(Tcount);
  //     $("#outputTerminal").text("停止温度轮询\n \n");
  //   });
  
  //   function refreshTemp(){
  //   $.post("/cp/t_refresh",{},function(data,status){
  //        $("#outputTerminal").text("メソッド：" + "post  戻り値："+data+"度address_adt7410 = 0x48"+" 状態：" + status);
  //        $("#outpuTemperature").html("温度：<b>"+data+"℃</b>");
  //     });
  // }
  // });
  
    //停止刷新按钮
  // $(document).ready(function(){
  
  // });
  
  
  
  </script>
</body>

  </html>